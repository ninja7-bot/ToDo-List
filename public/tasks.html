<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>To-Do List</title>
    <link rel="stylesheet" href="style.css" />
</head>
<body>
<div class="todo-container">
    <h2>To-Do List</h2>

    <form id="taskForm">
        <input type="text" id="taskName" class="task-input" placeholder="Add a new task" required />
        <button type="submit">Add Task</button>
    </form>

    <ul class="todo-list" id="taskList">
        <!-- Tasks will be inserted here -->
    </ul>
</div>

<script>
    const taskList = document.getElementById('taskList');
    const taskForm = document.getElementById('taskForm');
    const taskNameInput = document.getElementById('taskName');

    async function loadTasks() {
      try {
        const res = await fetch('/api/tasks_handler');
        const tasks = await res.json();
        taskList.innerHTML = '';
        tasks.forEach(task => {
          const li = document.createElement('li');
          li.textContent = task.taskName;
          taskList.appendChild(li);
        });
      } catch (err) {
        taskList.innerHTML = '<li>Error loading tasks</li>';
      }
    }

    taskForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const taskName = taskNameInput.value.trim();
      if (!taskName) return;

      try {
        const res = await fetch('/api/tasks_handler', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ taskName })
        });

        if (res.ok) {
          taskNameInput.value = '';
          await loadTasks();
        } else {
          alert('Failed to add task');
        }
      } catch (err) {
        alert('Error adding task');
      }
    });

    // Load tasks on page load
    loadTasks();
</script>
</body>
</html>
